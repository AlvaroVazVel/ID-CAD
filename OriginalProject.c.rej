diff a/OriginalProject.c b/OriginalProject.c	(rejected hunks)
@@ -63,7 +66,7 @@
                           
                         }  
                     }   
-               while(PIND.5 == 1 && PIND.4 == 0){//Pulso continuo no activo   
+               while(PIND.5 == 1 && PIND.4 == 0){//Pulso continuo no activo y Paso sentido derecho   
                     if (PINC.2 != 0){//Microswitch reposo salio de reposo   
                         if(PIND.6 == 0){//Bloqueo de salida activado o tambi�n el de entrada
                               PORTC.5 = 1; //Activa martillo  
@@ -86,16 +89,22 @@
                         if(PIND.2 == 0 && validation == 1){ // Se�al de paso
                            validation = 0;
                            numpasos++; 
-                           
+                     
+                          
                            
                           //DEFINICION DE RELOJ a 5s 
                            TCCR1B= 0x05; //Enciende timer 1 en modo normal con prescalador CK/1024  
                            
-                           while(TIFR1.TOV1==0){ //Mientras la bandera de overflow no sea 1        
+                           while(TIFR1.TOV1==0){ //Mientras la bandera de overflow no sea 1  
+                                   
                              
                              if(numpasos == 5)
                                 break;
                              
+                             if(PINC.2 == 1 && PINC.3 == 0){ 
+                                prev = 1;
+                                break;
+                             }
                              
                              if(PIND.2 == 1) // Se�al de paso 
                                 validation = 1; 
@@ -107,22 +116,25 @@
                                TCNT1L= 0xED; //Se pone 60653 dividido en los 8MSB para TCNT1H y los 8LSB para TCNT1L 
                              }       
                            } 
-                           TCCR1B=0;       //Apagar timer
-                 
+                           TCCR1B=0;       //Apagar timer 1 
+
+                           
+                          
                            for (i=0;i<numpasos;i++){ 
                                  TIFR1.TOV1=1;//Resetea la bandera de overflow
                                  TCCR1B= 0x05; //Enciende timer 1 en modo normal con prescalador CK/1024  
                                  TCNT1H= 0xD9; //Contador 65536 - 55769 inicia en 55769 para contar 9767 veces , .001024 segundos por cuenta
                                  TCNT1L= 0xD9; //Se pone 55769 dividido en los 8MSB para TCNT1H y los 8LSB para TCNT1L
                                 //TIENE 10 s para pasar
-                                while(TIFR1.TOV1==0){//mientras la bandera de overflow no sea 1 
+                                while(TIFR1.TOV1==0){//mientras la bandera de overflow no sea 1
                                     if(PINC.2 == 1 && PINC.4 == 0 && prev == 0){ // Para evitar que haga sentido opuesto
                                        while(PINC.4 == 0){//Mientras est� intentando entrar activa martillo  
                                             PORTC.5 = 1; //Activa martillo 
                                             delay_ms (200);
                                             PORTC.5 = 0; //Desactiva martillo
                                        }
-                                    }     
+                                    }   
+                                      
                                     if(PINC.3 == 0)
                                         prev  = 1;
 
@@ -151,13 +163,14 @@
                          if(PIND.2 == 0 && validation == 1){ // Se�al de paso
                            validation = 0;
                            numpasos = 1; 
+                           
                             
                              TIFR1.TOV1=1;//Resetea la bandera de overflow
                              TCCR1B= 0x05; //Enciende timer 1 en modo normal con prescalador CK/1024  
                              TCNT1H= 0xD9; //Contador 65536 - 55769 inicia en 55769 para contar 9767 veces , .001024 segundos por cuenta
                              TCNT1L= 0xD9; //Se pone 55769 dividido en los 8MSB para TCNT1H y los 8LSB para TCNT1L
                             //TIENE 10 s para pasar
-                             while(TIFR1.TOV1==0){//mientras la bandera de overflow no sea 1
+                             while(TIFR1.TOV1==0){//mientras la bandera de overflow no sea 1 
                                 if(PINC.2 == 1 && PINC.4 == 0 && prev == 0){ // Para evitar que haga sentido opuesto
                                    while(PINC.4 == 0){//Mientras est� intentando entrar activa martillo  
                                         PORTC.5 = 1; //Activa martillo 
@@ -184,9 +198,28 @@
                         }  
                     } 
                
-               }          
-              while (PIND.2==0){ //Mientras se�al de pulso activada
-                    PORTC.5 = 0; //Martillo desactivado
+               }                
+              while (PIND.2 == 0){ //Mientras se�al de pulso activada 
+                    
+                   if(PINC.2 == 1 && PINC.4 == 0 && prev == 0 && PIND.6 == 0){ // Para evitar que haga sentido opuesto
+                            while(PINC.4 == 0){//Mientras est� intentando entrar activa martillo  
+                                PORTC.5 = 1; //Activa martillo 
+                                delay_ms (200);
+                                PORTC.5 = 0; //Desactiva martillo
+                            }
+                   }   
+                                          
+                   if(PINC.3 == 0)
+                      prev  = 1;
+
+                   if(PINC.4 == 0)
+                      curre = 1; 
+                                           
+                                        
+                   if(prev == 1 && curre == 1 && PINC.2 == 0){
+                      prev = 0;
+                      curre = 0;
+                  }     
               }
               
         }   
@@ -207,7 +240,7 @@
                           
                         }  
                     }   
-               while(PIND.5 == 1 && PIND.4 == 1){//Pulso continuo no activo   
+               while(PIND.5 == 1 && PIND.4 == 1){//Pulso continuo no activo y Paso sentido izquierdo 
                     if (PINC.2 != 0){//Microswitch reposo salio de reposo   
                         if(PIND.6 == 0){//Bloqueo de salida activado o tambi�n el de entrada
                               PORTC.5 = 1; //Activa martillo  
@@ -230,6 +263,7 @@
                         if(PIND.2 == 0 && validation == 1){ // Se�al de paso
                            validation = 0;
                            numpasos++; 
+                        
                            
                           //DEFINICION DE RELOJ a 5s 
                            TCCR1B= 0x05; //Enciende timer 1 en modo normal con prescalador CK/1024  
@@ -241,6 +275,11 @@
                              if(numpasos == 5)
                                 break;
                              
+                             if(PINC.2 == 1 && PINC.4 == 0){ 
+                                prev = 1;
+                                break;
+                             }
+                             
                              if(PIND.2 == 0 && validation == 1){ // Se�al de paso
                                validation = 0; 
                                numpasos++;
@@ -283,7 +323,7 @@
                                 if(entry == 0){ //Checa la bandera de si el usuario pas�  
                                     break;
                                 }
-                           } 
+                           }
                            TCCR1B=0;       //Apagar timer
                            numpasos=0;
                          } 
@@ -300,7 +340,7 @@
                              TCNT1H= 0xD9; //Contador 65536 - 55769 inicia en 55769 para contar 9767 veces , .001024 segundos por cuenta
                              TCNT1L= 0xD9; //Se pone 55769 dividido en los 8MSB para TCNT1H y los 8LSB para TCNT1L
                             //TIENE 10 s para pasar
-                             while(TIFR1.TOV1==0){//mientras la bandera de overflow no sea 1 
+                             while(TIFR1.TOV1==0){//mientras la bandera de overflow no sea 1
                                 if(PINC.2 == 1 && PINC.3 == 0 && prev == 0){ // Para evitar que haga sentido opuesto
                                    while(PINC.3 == 0){//Mientras est� intentando entrar activa martillo  
                                         PORTC.5 = 1; //Activa martillo 
@@ -330,10 +371,27 @@
                
                }          
               while (PIND.2==0){ //Mientras se�al de pulso activada
-                    PORTC.5 = 0; //Martillo desactivado
+                    if(PINC.2 == 1 && PINC.3 == 0 && prev == 0 && PIND.6 == 0){ // Para evitar que haga sentido opuesto
+                            while(PINC.3 == 0){//Mientras est� intentando entrar activa martillo  
+                                PORTC.5 = 1; //Activa martillo 
+                                delay_ms (200);
+                                PORTC.5 = 0; //Desactiva martillo
+                            }
+                   }   
+                                          
+                   if(PINC.4 == 0)
+                      prev  = 1;
+
+                   if(PINC.3 == 0)
+                      curre = 1; 
+                                           
+                                        
+                   if(prev == 1 && curre == 1 && PINC.2 == 0){
+                      prev = 0;
+                      curre = 0;
+                  }
               }
               
         }   
    }
-}    
- 
\ No newline at end of file
+}
\ No newline at end of file
